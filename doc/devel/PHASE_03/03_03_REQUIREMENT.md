# 要件定義書 - vsmatrix PHASE 3

## 目的

本文書では、vsmatrix PHASE3 MVP(Minimum Viable Product) の開発に必要な要件を定義します。
次のPHASEへのたたき台となるとともに、最低限の実動作が実現できるかを確認します。
最低限の実動作とは、入力および出力VAIF(仮想オーディオインターフェース)の間に仮想的なパッチケーブルを接続し、
出力VAIFから入力VAIFへ音声が流れることを確認します。


## 概要
### 機能概要

PHASE 3では設定ファイルは使わず、出力VAIF(仮想オーディオインターフェース)1個と入力VIAF1個を生成します。出力VAIFへの外部アプリからの入力値を入力VIAFに受け渡す、仮想的なパッチケーブルを作成します。外部アプリでは、これらのVAIFを入力や出力に設定でき、出力をループバックできます。PHASE3はコマンドラインツールとして実装します。

### コマンド

```sh
vsmatrix [--register|--unregister]
```

**--register**: VAIF1_INPUTという名前の入力VAIFと、VAF1_OUTOUTという名前の出力VAIFを仮想デバイスとして作成し、OSに登録します。ユーザーは音声入力にVAIF1_INPUTを指定でき、同様に音声出力にVAIF1_OUTPUTを出力します。
VAIF1_OUTPUTからVAIF1_INPUTへは仮想的なパッチケーブルが接続されていて、VAIF1_OUTPUTへの出力音声は、そのままVAIF1_INPUTにループバックします。既にこれらの名前が存在する場合は以下の処理に分かれます。
- vsmatrixが生成した仮想デバイスの場合: 何もせず成功します
- vsmatrix以外のデバイスの場合: エラーを返します(-1)。エラーメッセージを表示します。

**--unregister**: VAIF1_INPUT及びVAIF1_OUTPUTという名前の仮想デバイスを削除します。存在しない場合はなにもしません。これらの名前のデバイスがvsmatrixが作ったものでない場合はエラーを返し（-1）、エラーメッセージを表示します。

### ペルソナと特性

ユーザーは開発者(lulliecat)1人とします。今後の開発の足掛かりとしてのみ使います。

### 動作環境

Windows11 Pro x64環境で動作します。

### 前提条件

デバイスドライバの署名はテストのものを使います。

### 制約条件

未検討です。

## 機能要件

## 非機能要件

## UI要件

## 受け入れ基準
